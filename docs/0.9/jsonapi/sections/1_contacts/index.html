<!DOCTYPE html>
<html lang="en">
    <head>
  <title>Flapjack, monitoring notification routing + event processing</title>
  <link rel="stylesheet" href="/stylesheets/bootstrap.min.css"/>
  <link rel="stylesheet" href="/stylesheets/api-screen.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/api-syntax.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/github-markdown.css" type="text/css">
  <link rel="shortcut icon" href="/images/flapjack-2013-favicon-64-32-24-16.ico" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    .markdown-body {
        min-width: 200px;
        max-width: 790px;
        margin: 0 auto;
        padding: 30px;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 0px">
    <div class="container-fluid" id="navfluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigationbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
          <img class="logo" src="/images/flapjack-2013-notext-transparent-300-300.png"/>
          <span class="name">Flapjack</span>
        </a>
      </div>
      <div class="collapse navbar-collapse" id="navigationbar">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/docs/1.0/usage/quickstart">Quickstart</a></li>
          <li><a href="/docs">Documentation</a></li>
          <li><a href="/support">Support</a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>

    <center>
        <div class="alert alert-info" style="padding-top: 10px; padding-bottom: 0px; margin-bottom: 0px; height: 40px">
    <strong>This is documentation for Flapjack version 0.9:</strong>
    If you're looking for version 1.0 documentation, click <a class="alert-link" href="http://flapjack.io/docs/1.0">here.</a>
  </div>

    </center>
    <div class="container content">
      <div class="row">
        <div class="col-md-offset-1 col-md-10">
        <h1 id='contacts'>Contacts</h1>
<p>The Contact resource has the following attributes:</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>timezone</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>tags</td>
<td>Array[String]</td>
<td></td>
</tr>
</tbody></table>
<h2 id='create-contacts'>Create contacts</h2>
<p>Creates one or more contacts, returns an array containing the ids of the created contacts. The ordering is preserved, so if you POST an array of three contacts, the resulting array of ids will be in the same order as the posted data; the first item of the POSTed array will correspond to the first id in the resulting array, etc.</p>

<p>Contact ids may optionally be supplied. If it is omitted, then a UUID will be created.</p>

<p>If an id is supplied in any of the included contacts, and any of them clash with an existing contact, the whole request will be rejected and no changes will be written.</p>
<pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X POST -H <span class="s2">"Content-Type: application/vnd.api+json"</span> -d <span class="se">\</span>
 <span class="s1">'{
    "contacts": [
      {
        "first_name": "Ada",
        "last_name": "Lovelace",
        "email": "ada@example.com",
        "timezone": "Europe/London",
        "tags": [
          "legend",
          "first computer programmer"
        ]
      }
    ]
  }'</span> <span class="se">\</span>
 http://localhost:3081/contacts
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">create_contacts</span><span class="p">({</span>
  <span class="ss">:first_name</span> <span class="o">=&gt;</span> <span class="s2">"Ada"</span><span class="p">,</span>
  <span class="ss">:last_name</span>  <span class="o">=&gt;</span> <span class="s2">"Lovelace"</span><span class="p">,</span>
  <span class="ss">:email</span>      <span class="o">=&gt;</span> <span class="s2">"ada@example.com"</span>
<span class="p">})</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre><code class="highlight json"><span class="p">[</span><span class="s2">"cd40283b-023e-43e2-a79c-1910415afdc2"</span><span class="p">]</span><span class="w">
</span></code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">POST /contacts</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>contacts</td>
<td>Array[Contact]</td>
<td>An array of Contact resources to create.</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>201</td>
<td>The submitted contacts were created successfully.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted contact data was not sent with the JSONAPI MIME type <code class="prettyprint">application/vnd.api+json</code>.</td>
</tr>
<tr>
<td>409</td>
<td><strong>Error</strong> Contacts with ids matching those submitted were found.</td>
</tr>
<tr>
<td>422</td>
<td><strong>Error</strong> The submitted contact data did not conform to the provided specification.</td>
</tr>
</tbody></table>
<h2 id='get-contacts'>Get contacts</h2>
<p>If no contact ids are provided then all contacts will be returned; if contact ids
are provided then only the contacts matching those ids will be returned.</p>
<pre><code class="highlight shell">curl http://localhost:3081/contacts

<span class="c"># or</span>
curl http://localhost:3081/contacts/1

<span class="c"># or</span>
curl http://localhost:3081/contacts/21,22
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">contacts</span>

<span class="c1"># or</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">contacts</span><span class="p">(</span><span class="s1">'21'</span><span class="p">)</span>

<span class="c1"># or</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">contacts</span><span class="p">(</span><span class="s1">'21'</span><span class="p">,</span> <span class="s1">'22'</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>The commands return JSON structured like this, which is broken up by Flapjack::Diner into its constituent hashes:</p>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"contacts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"21"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ada"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lovelace"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ada@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Europe/London"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"legend"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"first computer programmer"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"entities"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"7"</span><span class="p">,</span><span class="w"> </span><span class="s2">"12"</span><span class="p">,</span><span class="w"> </span><span class="s2">"83"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"media"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"21_email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"21_sms"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"notification_rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"30fd36ae-3922-4957-ae3e-c8f6dd27e543"</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"22"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Charles"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Babbage"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"babbage@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UTC"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"grump"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"entities"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"media"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"22_email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"22_sms"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"notification_rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"bfd8be61-3d80-4b95-94df-6e77183ce4e3"</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">GET /contacts</code></p>

<p><strong>or</strong></p>

<p><code class="prettyprint">GET /contacts/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<p>None.</p>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>
<h2 id='update-contacts'>Update contacts</h2>
<p>Update one or more attributes for one or more contact resources.</p>
<pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X PATCH -H <span class="s2">"Content-Type: application/json-patch+json"</span> -d <span class="se">\</span>
<span class="s1">'[
  {"op"    : "replace",
   "path"  : "/contacts/0/first_name",
   "value" : "John"},
  {"op"    : "replace",
   "path"  : "/contacts/0/last_name",
   "value" : '</span>Smith<span class="s1">'}
]'</span> <span class="se">\</span>
 <span class="s1">'http://localhost:3081/contacts/23'</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">update_contacts</span><span class="p">(</span>
  <span class="mi">23</span><span class="p">,</span>
  <span class="ss">:first_name</span> <span class="o">=&gt;</span> <span class="s1">'John'</span><span class="p">,</span>
  <span class="ss">:last_name</span>  <span class="o">=&gt;</span> <span class="s1">'Smith'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">PATCH /contacts/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<p>Parameters sent for contact updates must form a valid <a href="http://tools.ietf.org/html/rfc6902">JSON Patch (RFC 6902)</a> document. This is comprised of a bare JSON array of JSON-Patch operation objects, which have three members:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>op</td>
<td>String</td>
<td>one of <em>replace</em> (for attributes), <em>add</em> or <em>remove</em> (for linked objects)</td>
</tr>
<tr>
<td>path</td>
<td>String</td>
<td>&ldquo;/contacts/0/ATTRIBUTE&rdquo; (e.g. &lsquo;first_name&rsquo;) or &ldquo;/contacts/0/links/LINKED_OBJ&rdquo; (e.g. &lsquo;media&rsquo;)</td>
</tr>
<tr>
<td>value</td>
<td>-&gt;</td>
<td>for attributes, a value of the correct data type for that attribute; for linked objects, the String id of that object</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>The submitted contact updates were made successfully. No content is returned.</td>
</tr>
<tr>
<td>404</td>
<td>Contact resources could not be found for one or more of the provided ids. No contact resources were altered by this request.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted contact data was not sent with the JSON-Patch MIME type <code class="prettyprint">application/json-patch+json</code>.</td>
</tr>
</tbody></table>
<h2 id='delete-contacts'>Delete contacts</h2>
<p>Delete one or more contacts.</p>
<pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X DELETE <span class="se">\</span>
  <span class="s1">'http://localhost:3081/contacts/21'</span>

<span class="c"># or</span>
curl -w <span class="s1">'response: %{http_code} \n'</span> -X DELETE <span class="se">\</span>
  <span class="s1">'http://localhost:3081/contacts/21,22'</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">delete_contacts</span><span class="p">(</span><span class="s1">'21'</span><span class="p">)</span>

<span class="c1"># or</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">delete_contacts</span><span class="p">(</span><span class="s1">'21'</span><span class="p">,</span> <span class="s1">'22'</span><span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">DELETE /contacts/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<p>None.</p>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>Contact(s) were deleted</td>
</tr>
<tr>
<td>404</td>
<td>Contacts could not be found for one or more of the provided ids. No contacts were deleted by this request.</td>
</tr>
</tbody></table>

      </div>
    </div>
  </div> <!-- container -->

  <footer>
<div class="row">
<div class="col-md-4 col-md-offset-2">
  Flapjack was conceptualised by
  <a href="https://twitter.com/auxesis">Lindsay Holmwood</a>.
  <a href="https://twitter.com/jessereynolds">Jesse Reynolds</a> and
  <a href="https://github.com/ali-graham">Ali Graham</a>
  are the primary developers.
  View the project on <a href="https://github.com/flapjack/flapjack">GitHub</a>.
</div>
<div class="col-md-4 sponsor">
  <a href="http://bulletproof.net.au" target="_bulletproof">
    <img class="bulletproof" src="/images/bulletproof-logo.png"/>
  </a>
  <span class="bulletproof subtext">
    Development sponsored by
    <a href="http://bulletproof.net.au" target="_bulletproof">Bulletproof</a>.
  </span>
</div>
</div>
</footer>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-388962-5");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

</body>
</html>
