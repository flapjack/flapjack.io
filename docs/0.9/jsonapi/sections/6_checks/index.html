<!DOCTYPE html>
<html lang="en">
    <head>
  <title>Flapjack, monitoring notification routing + event processing</title>
  <link rel="stylesheet" href="/stylesheets/bootstrap.min.css"/>
  <link rel="stylesheet" href="/stylesheets/api-screen.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/api-syntax.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/github-markdown.css" type="text/css">
  <link rel="shortcut icon" href="/images/flapjack-2013-favicon-64-32-24-16.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    .markdown-body {
        min-width: 200px;
        max-width: 790px;
        margin: 0 auto;
        padding: 30px;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 0px">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">
        <img class="logo" src="/images/flapjack-2013-notext-transparent-300-300.png"/>
        <span class="name">Flapjack</span>
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/docs/1.0/usage/quickstart">Quickstart</a></li>
        <li><a href="/docs">Documentation</a></li>
        <li><a href="/support">Support</a></li>
      </ul>
    </div>
  </nav>

    <center>
        <div class="alert alert-info" style="padding-top: 10px; padding-bottom: 0px; margin-bottom: 0px; height: 40px">
      <strong>This is documentation for Flapjack version 0.9:</strong>
      If you're looking for version 1.0 documentation, click <a class="alert-link" href="http://flapjack.io/docs/1.0">here.</a>
  </div>

    </center>
    <div class="container content">
      <div class="row">
        <div class="col-md-offset-1 col-md-10">
        <h1 id='checks'>Checks</h1><h2 id='disable-a-check'>Disable a check</h2>
<p>Disable a check (by setting its enabled attribute to false). This is currently
the only supported check property for updates via the JSONAPI, due to
limitations in the underlying data storage model. This will be addressed in
future Flapjack releases.</p>

<p>(Checks are re-enabled when new events are generated for them.)</p>
<pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X PATCH -H <span class="s2">"Content-Type: application/json-patch+json"</span> -d <span class="se">\</span>
<span class="s1">'[
  {"op"    : "replace",
   "path"  : "/checks/0/enabled",
   "value" : false}
]'</span> <span class="se">\</span>
 <span class="s1">'http://localhost:3081/checks/www.example.com%3APING'</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">update_checks</span><span class="p">(</span>
  <span class="s1">'www.example.com:PING'</span><span class="p">,</span>
  <span class="ss">:enabled</span> <span class="o">=&gt;</span> <span class="kp">false</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">PATCH /checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<p>Parameters sent for check updates must form a valid <a href="http://tools.ietf.org/html/rfc6902">JSON Patch (RFC 6902)</a> document. This is comprised of a bare JSON array of JSON-Patch operation objects, which have three members:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>op</td>
<td>String</td>
<td>&ldquo;replace&rdquo;</td>
</tr>
<tr>
<td>path</td>
<td>String</td>
<td>&ldquo;/checks/0/enabled&rdquo;</td>
</tr>
<tr>
<td>value</td>
<td>Boolean</td>
<td>true or false</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>The check(s) were updated successfully.</td>
</tr>
<tr>
<td>404</td>
<td><strong>Error</strong> No matching checks were found.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted check data was not sent with the JSON-Patch MIME type <code class="prettyprint">application/json-patch+json</code>.</td>
</tr>
<tr>
<td>422</td>
<td><strong>Error</strong> The submitted check data did not conform to the provided specification.</td>
</tr>
</tbody></table>
<h2 id='create-scheduled-maintenance-periods-on-checks'>Create scheduled maintenance periods on checks</h2><pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X POST -H <span class="s2">"Content-type: application/vnd.api+json"</span> -d <span class="se">\</span>
 <span class="s1">'{
    "scheduled_maintenances": [
      {
        "start_time" : "2014-04-09T16:03:25+09:30",
        "duration" : 3600,
        "summary" : "memory replacement"
      }
    ]
  }'</span> <span class="se">\</span>
 http://localhost:3081/scheduled_maintenances/checks/example.com:SSH
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">create_scheduled_maintenances_checks</span><span class="p">(</span>
  <span class="s1">'example.com:SSH'</span><span class="p">,</span>
  <span class="ss">:start_time</span> <span class="o">=&gt;</span> <span class="s1">'2014-04-09T16:03:25+09:30'</span><span class="p">,</span>
  <span class="ss">:duration</span>   <span class="o">=&gt;</span> <span class="mi">3600</span><span class="p">,</span>
  <span class="ss">:summary</span>    <span class="o">=&gt;</span> <span class="s1">'memory replacement'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">POST /scheduled_maintenances/checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start_time</td>
<td>String</td>
<td>A date &amp; time in ISO 8601 format (YYYY-MM-DDThh:mm:ssZ)</td>
</tr>
<tr>
<td>duration</td>
<td>Integer</td>
<td>A length of time (in seconds) that the created scheduled maintenance periods should last.</td>
</tr>
<tr>
<td>summary</td>
<td>String</td>
<td>A summary of the reason for the maintenance period.</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>The submitted scheduled maintenance periods were created successfully.</td>
</tr>
<tr>
<td>403</td>
<td><strong>Error</strong> The required &lsquo;start_time&rsquo; parameter was not sent.</td>
</tr>
<tr>
<td>404</td>
<td><strong>Error</strong> No matching checks were found.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted parameters were not sent with the JSONAPI MIME type <code class="prettyprint">application/json</code>.</td>
</tr>
</tbody></table>
<h2 id='delete-scheduled-maintenance-periods-on-checks'>Delete scheduled maintenance periods on checks</h2><pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X DELETE <span class="se">\</span>
  <span class="s1">'http://localhost:3081/scheduled_maintenances/checks/example.com:PING?start_time=2014-05-09T16:12:16+09:30'</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">delete_scheduled_maintenances_checks</span><span class="p">(</span>
  <span class="s1">'example.com:PING'</span><span class="p">,</span>
  <span class="ss">:end_time</span> <span class="o">=&gt;</span> <span class="s1">'2014-05-09T16:12:16+09:30'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">DELETE /scheduled_maintenances/checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start_time</td>
<td>String</td>
<td>A date &amp; time in ISO 8601 format (YYYY-MM-DDThh:mm:ssZ)</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>Matching unscheduled maintenance periods were deleted.</td>
</tr>
<tr>
<td>403</td>
<td><strong>Error</strong> The required &lsquo;start_time&rsquo; parameter was not sent.</td>
</tr>
<tr>
<td>404</td>
<td><strong>Error</strong> No matching checks were found.</td>
</tr>
</tbody></table>
<h2 id='create-unscheduled-maintenance-periods-on-checks'>Create unscheduled maintenance periods on checks</h2><pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X POST -H <span class="s2">"Content-type: application/vnd.api+json"</span> -d <span class="se">\</span>
 <span class="s1">'{
    "unscheduled_maintenances": [
      {
        "duration" : 3600,
        "summary" : "fixing now"
      }
    ]
  }'</span> <span class="se">\</span>
 http://localhost:3081/unscheduled_maintenances/checks/example.com:HOST
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">create_unscheduled_maintenances_checks</span><span class="p">(</span>
  <span class="s1">'example.com:HOST'</span><span class="p">,</span>
  <span class="ss">:duration</span> <span class="o">=&gt;</span> <span class="mi">3600</span><span class="p">,</span>
  <span class="ss">:summary</span>  <span class="o">=&gt;</span> <span class="s1">'fixing now'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">POST /unscheduled_maintenances/checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>duration</td>
<td>Integer</td>
<td>A length of time (in seconds) that the unscheduled maintenance period(s) should last.</td>
</tr>
<tr>
<td>summary</td>
<td>String</td>
<td>A summary of the reason for the creation of the unscheduled maintenance period(s).</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>The submitted unscheduled maintenance periods were created successfully.</td>
</tr>
<tr>
<td>404</td>
<td><strong>Error</strong> No matching checks were found.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted parameters were not sent with the JSONAPI MIME type <code class="prettyprint">application/json</code>.</td>
</tr>
</tbody></table>
<h2 id='update-unscheduled-maintenance-periods-on-checks'>Update unscheduled maintenance periods on checks</h2><pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X PATCH -H <span class="s2">"Content-Type: application/json-patch+json"</span> -d <span class="se">\</span>
<span class="s1">'[
  {"op"    : "replace",
   "path"  : "/unscheduled_maintenances/0/end_time",
   "value" : "2014-04-09T16:12:16+09:30"},
]'</span> <span class="se">\</span>
 <span class="s1">'http://localhost:3081/unscheduled_maintenances/checks/example.com:PING'</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">update_unscheduled_maintenances_checks</span><span class="p">(</span>
  <span class="s1">'example.com:PING'</span><span class="p">,</span>
  <span class="ss">:end_time</span> <span class="o">=&gt;</span> <span class="s1">'2014-04-09T16:12:16+09:30'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">PATCH /unscheduled_maintenances/checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<p>Parameters sent for unscheduled maintenance period updates must form a valid <a href="http://tools.ietf.org/html/rfc6902">JSON Patch (RFC 6902)</a> document. This is comprised of a bare JSON array of JSON-Patch operation objects, which have three members:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>op</td>
<td>String</td>
<td>may only be <em>replace</em></td>
</tr>
<tr>
<td>path</td>
<td>String</td>
<td>&ldquo;/unscheduled_maintenances/0/ATTRIBUTE&rdquo; (e.g. &lsquo;end_time&rsquo;)</td>
</tr>
<tr>
<td>value</td>
<td>-&gt;</td>
<td>a value of the correct data type for the attribute in the path</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>Matching unscheduled maintenance periods were updated successfully. No content is returned.</td>
</tr>
<tr>
<td>404</td>
<td>Entity/check resources could not be found for one or more of the provided ids. No unscheduled maintenance periods were altered by this request.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted data was not sent with the JSON-Patch MIME type <code class="prettyprint">application/json-patch+json</code>.</td>
</tr>
</tbody></table>
<h2 id='create-test-notifications-on-checks'>Create test notifications on checks</h2><pre><code class="highlight shell">curl -w <span class="s1">'response: %{http_code} \n'</span> -X POST -H <span class="s2">"Content-type: application/vnd.api+json"</span> -d <span class="se">\</span>
 <span class="s1">'{
    "test_notifications": [
      {
        "summary" : "testing, testing, 1, 2, 3"
      }
    ]
  }'</span> <span class="se">\</span>
 http://localhost:3081/test_notifications/checks/example.com:HOST
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s1">'flapjack-diner'</span>
<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">base_uri</span><span class="p">(</span><span class="s1">'localhost:3081'</span><span class="p">)</span>

<span class="no">Flapjack</span><span class="o">::</span><span class="no">Diner</span><span class="p">.</span><span class="nf">create_test_notifications_checks</span><span class="p">(</span>
  <span class="s1">'example.com:HOST'</span><span class="p">,</span>
  <span class="ss">:summary</span> <span class="o">=&gt;</span> <span class="s1">'testing, testing, 1, 2, 3'</span>
<span class="p">)</span>
</code></pre>
<h3 id='http-request'>HTTP Request</h3>
<p><code class="prettyprint">POST /test_notifications/checks/ID[,ID,ID...]</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>summary</td>
<td>String</td>
<td>A summary of the reason for the creation of the test notifications.</td>
</tr>
</tbody></table>
<h3 id='http-return-codes'>HTTP Return Codes</h3>
<table><thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>The submitted test notifications were created successfully.</td>
</tr>
<tr>
<td>404</td>
<td><strong>Error</strong> No matching checks were found.</td>
</tr>
<tr>
<td>405</td>
<td><strong>Error</strong> The submitted parameters were not sent with the JSONAPI MIME type <code class="prettyprint">application/json</code>.</td>
</tr>
</tbody></table>

      </div>
    </div>
  </div> <!-- container -->

  <footer>
<div class="row">
<div class="col-md-4 col-md-offset-2">
  Flapjack was conceptualised by
  <a href="https://twitter.com/auxesis">Lindsay Holmwood</a>.
  <a href="https://twitter.com/jessereynolds">Jesse Reynolds</a> and
  <a href="https://github.com/ali-graham">Ali Graham</a>
  are the primary developers.
  View the project on <a href="https://github.com/flapjack/flapjack">GitHub</a>.
</div>
<div class="col-md-4 sponsor">
  <a href="http://bulletproof.net.au" target="_bulletproof">
    <img class="bulletproof" src="/images/bulletproof-logo.png"/>
  </a>
  <span class="bulletproof subtext">
    Development sponsored by
    <a href="http://bulletproof.net.au" target="_bulletproof">Bulletproof</a>.
  </span>
</div>
</div>
</footer>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-388962-5");
    pageTracker._trackPageview();
  } catch(err) {}
</script>

</body>
</html>
